---
layout: post
title: 'IFSF CTF #10 - Memories of never ending pain'
date: 2012-02-13 21:33:43.000000000 -05:00
type: post
published: true
status: publish
categories:
- Writeups
tags:
- exploitation
- ifsf
- mitch
- reverse engineering
- scott
meta:
  _edit_last: '1'
author:
  login: csgadmin
  email: utdcsg@gmail.com
  display_name: csgadmin
  first_name: ''
  last_name: ''
---
<p><strong>Authors</strong>: Mitchell Adair, Scott Hand</p>
<p>The problem starts out with the following text :</p>
<p><em>"We succeeded on gaining access to an old machine. We found an interesting binary that requests for an authorization code.<br />
We believe that this code is still used somewhere else.</p>
<p>http://ctf.forbiddenbits.net/tasks/10.exe"</em></p>
<p>After opening the program in IDA, we realized it was an old-school DOS program. Installing DOS turned out to be a pain, so we ended up using a DOS emulator, DOSBOX (<a href="http://www.dosbox.com/">http://www.dosbox.com/</a>). There are several version, so the debugging version is an import note.</p>
<p>To execute the program in DOSBOX you have to do 2 steps :<br />
1. Mount your harddrive, "<em>mount c c:\users\myuser\myproblemdir"</em><br />
2. Debug the program in debugging mode, "<em>debug 10.exe</em>"</p>
<p>So... after playing around with the program in debug mode, and looking at the program in IDA, there are a few major components that make up this program.</p>
<p>Three main function calls that represent the control flow of the program:</p>
<p><a href="https://csg.utdallas.edu/wp-content/uploads/2012/08/debug-pic.png"><img class="alignnone size-full wp-image-121" title="IFSF Pic1" src="{{ site.baseurl }}/assets/debug-pic.png" alt="" width="825" height="772" /></a></p>
<p>Looking a little more carefully at how the user input gets stored we see a little is applied to each character, before it is finally stored in [si]:</p>
<p><a href="https://csg.utdallas.edu/wp-content/uploads/2012/08/store-user-input.png"><img class="alignnone size-full wp-image-124" title="IFSF Pic2" src="{{ site.baseurl }}/assets/store-user-input.png" alt="" width="732" height="772" /></a></p>
<p>We can also see exactly where the altered user input is compared to a hard coded string in the program. If a value does match dx get's or'd with 5, essentially acting as a flag:</p>
<p><a href="https://csg.utdallas.edu/wp-content/uploads/2012/08/key-comparison.png"><img class="alignnone size-full wp-image-122" title="IFSF Pic3" src="{{ site.baseurl }}/assets/key-comparison.png" alt="" width="1465" height="993" /></a></p>
<p>Finally, we now know what happens to our user input, and we can see the final string we must match. A little python script can solve this problem :</p>
<p><a href="https://csg.utdallas.edu/wp-content/uploads/2012/08/python-solution.png"><img class="alignnone size-full wp-image-123" title="IFSF Pic4" src="{{ site.baseurl }}/assets/python-solution.png" alt="" width="702" height="381" /></a></p>
<p>And the solution is : 7R0LO101O</p>
